---
published: false
---
## Free Space Map

Free Sapce Map은, 테이블이 저장되는 데이터파일에서 비어있는 공간을 관리하는 별도의 데이터 구조체입니다. 새로운 자료의 추가 또는 기존 자료의 변경이 발생하였을 경우, 테이블에는 새로운 Tuple이 생성되는데, Tuple을 생성하기 위해서는 기본적으로 사용하지 않는 새로운 Buffer 할당이 발생하여야 합니다. 메모리 상에서 버퍼를 할당하는 것은 단순하게, 메모리 할당을 통해서 문제를 해결할 수 있지만, 파일 입장에서는 기존에 있는 파일 내용 중 비어 있는 부분을 찾고, 새롭게 생성되는 Tuple의 양에 맞추어서 할당 할 수 있는지 문제를 즉시 확인할 수 있어야 합니다. 

이를 위해서 준비한 기법이 Free space map입니다. 

Freespace Map은 해당 테이블(postgres에서는 Relation이라고 부릅니다만) 정보가 저장되는 대상 데이터 파일에 대하여, Tree 형태의 자료구조를 활용하여, 비어 있는 공간을 즉각 확인할 수 있게 지원해 줍니다.

포스트그레스 8.4이후부터, 개별 테이블 파일에 저장되던 고정 크기의 Freespace Map이 독립적인 파일에 저장되도록 변경되었습니다.

### 구조



